var subscribe_geo_geocoded={};function subscribe_geo_geocode(){var a=$("#sub_geocode_wrapper");a.hide();var c=prompt("Please enter the place name you're looking for and\nwe'll ask Flickr for matching WOE IDs\n\n(this might take a few seconds)\n\n");if(!c){return}if(subscribe_geo_geocoded[c]){subscribe_geo_display(subscribe_geo_geocoded[c]);return}var b="http://api.flickr.com/services/rest/?method=flickr.places.find&format=json&nojsoncallback=1";b+="&api_key=4d5ab73de9b0ea433491a45a24187503";b+="&query="+c;$.ajax({url:b,error:function(){alert("Hrmph... there was an unknown error geocoding your query.")},success:function(d){try{d=JSON.parse(d)}catch(f){alert("Ack! It looks like Flickr sent back bunk data for your query.");return}if(d.stat!="ok"){alert("Sad face. The Flickr API returned an error...");return}subscribe_geo_geocoded[c]=d;subscribe_geo_display(d)}})}function subscribe_geo_display(b){var g=b.places["place"].length;if(!g){alert("Alas... there's nothing matching that query.");return}var f=new Array();for(var e=0;e<g;e++){var c=b.places["place"][e]["_content"];var h=b.places["place"][e]["woeid"];var d='<li><a href="#" onclick="subscribe_geo_set_woeid('+h+');return false;">'+c+'</a><span style="color:#ccc;"> &#8212; WOE ID #'+h+"</span></li>";f.push(d)}$("#sub_geocode_results").html(f.join(""));var a=$("#sub_geocode_wrapper");a.show()}function subscribe_geo_set_woeid(g){var f=$("#woeids").val();var d=(f)?f.split(","):new Array();var e=d.length;var b=0;for(var c=0;c<e;c++){if(d[c]==g){b=1;break}}if(!b){d.push(g);$("#woeids").val(d.join(","))}var a=$("#sub_geocode_wrapper");a.hide()};